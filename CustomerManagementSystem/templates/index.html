{% extends "base.html" %}
{% block title %}系統主控台 - 客戶管理系統{% endblock %}
{% block content %}
<!-- 如需保留原有卡片設計，您可將原有 CSS 與卡片結構放在此區塊中 -->
<style>
  :root {
    --transition-duration: 0.3s;
    --card-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
  }
  .system-card {
    transition: transform var(--transition-duration) ease, 
                box-shadow var(--transition-duration) ease;
  }
  .system-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--card-shadow);
  }
  .feature-card {
    min-height: 280px;
    border: none;
    border-radius: 1rem;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s ease, transform 0.5s ease;
    background: linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(248,249,250,0.98) 100%);
    backdrop-filter: blur(10px);
  }
  .feature-card.loaded {
    opacity: 1;
    transform: translateY(0);
  }
  .icon-wrapper {
    width: 64px;
    height: 64px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
  }
  .card-title {
    text-align: center;
    font-weight: 600;
  }
  .card-text {
    text-align: center;
    color: #6c757d;
  }
  @media (max-width: 768px) {
    .feature-card {
      min-height: auto;
      margin-bottom: 1.5rem;
    }
    .card-title {
      font-size: 1.25rem;
    }
  }
</style>

<main class="container my-5" style="padding-top: 80px;">
  <div class="card shadow-lg system-card border-0 overflow-hidden">
    <div class="card-header bg-transparent border-0 py-4">
      <h1 class="card-title text-primary mb-0 fs-3">
        <i class="bi bi-speedometer2 me-2"></i>系統主控台
      </h1>
    </div>
    <div class="card-body p-4">
      <div class="row g-4 justify-content-center">
        <!-- 新增客戶卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-success bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-person-plus-fill fs-2 text-success"></i>
                </div>
                <h2 class="h4 card-title mb-3">新增客戶檔案</h2>
                <p class="card-text mb-4">
                  建立新的客戶資料記錄，包括聯絡資訊與平面圖。
                </p>
              </div>
              <a href="{{ url_for('add_customer') }}" class="btn btn-success btn-lg w-100">
                <i class="bi bi-plus-circle me-2"></i>開始新增
              </a>
            </div>
          </div>
        </div>
        <!-- 客戶資料管理卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-info bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-files-alt fs-2 text-info"></i>
                </div>
                <h2 class="h4 card-title mb-3">客戶資料管理</h2>
                <p class="card-text mb-4">
                  瀏覽與維護所有客戶資料，並進行搜尋與篩選。
                </p>
              </div>
              <a href="{{ url_for('customers') }}" class="btn btn-info btn-lg w-100">
                <i class="bi bi-table me-2"></i>管理列表
              </a>
            </div>
          </div>
        </div>
        <!-- 請款流程管理卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-warning bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-receipt fs-2 text-warning"></i>
                </div>
                <h2 class="h4 card-title mb-3">請款流程管理</h2>
                <p class="card-text mb-4">
                  管理請款流程，輸入未支付金額及更新流程進度。
                </p>
              </div>
              <a href="{{ url_for('billing') }}" class="btn btn-warning btn-lg w-100">
                <i class="bi bi-receipt me-2"></i>請款流程
              </a>
            </div>
          </div>
        </div>
        <!-- 維修追蹤卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-primary bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-clipboard2-check fs-2 text-primary"></i>
                </div>
                <h2 class="h4 card-title mb-3">維修追蹤</h2>
                <p class="card-text mb-4">
                  顯示所有待處理的報修紀錄，方便追蹤未完成的維修狀態。
                </p>
              </div>
              <a href="{{ url_for('tracking') }}" class="btn btn-primary btn-lg w-100">
                <i class="bi bi-clipboard2-check me-2"></i>維修追蹤
              </a>
            </div>
          </div>
        </div>
        <!-- 工程進度卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-dark bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-building fs-2 text-dark"></i>
                </div>
                <h2 class="h4 card-title mb-3">工程進度</h2>
                <p class="card-text mb-4">
                  查看客戶工程進度，包含報價確認、開始施工與完工日期。
                </p>
              </div>
              <a href="{{ url_for('progress') }}" class="btn btn-dark btn-lg w-100">
                <i class="bi bi-building me-2"></i>工程進度
              </a>
            </div>
          </div>
        </div>
        {% if session.get('user') and session.user.role == 'admin' %}
        <!-- 使用者管理卡片 -->
        <div class="col-lg-4 col-md-6">
          <div class="card h-100 feature-card gradient-light shadow">
            <div class="card-body d-flex flex-column justify-content-between p-4">
              <div>
                <div class="icon-wrapper bg-secondary bg-opacity-10 rounded-circle p-3">
                  <i class="bi bi-gear fs-2 text-secondary"></i>
                </div>
                <h2 class="h4 card-title mb-3">使用者管理</h2>
                <p class="card-text mb-4">
                  管理系統使用者，包含新增、修改與刪除帳號（僅限管理者）。
                </p>
              </div>
              <a href="{{ url_for('manage_users') }}" class="btn btn-secondary btn-lg w-100">
                <i class="bi bi-gear me-2"></i>管理使用者
              </a>
            </div>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(el => new bootstrap.Tooltip(el))
      document.querySelectorAll('.feature-card').forEach((card, index) => {
          setTimeout(() => card.classList.add('loaded'), index * 150)
      })
  })
</script>
{% endblock %}
